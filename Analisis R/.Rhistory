datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
View(datos)
str(datos)
table(datos$Estado)
prop.table(table(datos$Estado))
n<-nrow(datos)
table(datos$Estado)[2]
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=1000)
n<-nrow(datos)
n
x<-table(datos$Estado)[2]
x
# La previa de Jeffreys es Beta(0.5,0.5)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=1000)
summary(posterior)
plot(posterior)
grid <- seq(0,1,0.01)
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 16, 32), type="l", col="red", lwd=3, ylim=c(0,8),
xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red", lwd=3,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
plot(density(posterior))
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0:100), lwd=3,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=3,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend(topright, c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend(40, 8, c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend("topright", c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend("topright", c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid()
x <- 0:1
curve(dbeta(x, 0.5+x, 0.5+n-x), xlab = "x", ylab = "f(x;a,b)", 0,1, col = "red", lwd = 2,
main = "")
curve(dbeta(x, 0.5, 0.5), xlab = "x", ylab = "f(x;a,b)", 0, 1, col = "purple", lwd = 2,
add = TRUE)
legend("topleft", c( "Posterior","Previa"), col = c( "red", "purple"), lwd = 2, inset = 0.05)
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend("topright", c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
geweke.diag(posterior)
coda::geweke.plot(posterior)
coda::raftery.diag(posterior) # Longitud de la cadena
n<-nrow(datos)
n
x<-table(datos$Estado)[2]
x
# La previa de Jeffreys es Beta(0.5,0.5)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=4000)
summary(posterior)
plot(posterior)
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
coda::raftery.diag(posterior) # Longitud de la cadena
coda::geweke.plot(posterior)
coda::autocorr.plot(posterior)
coda::geweke.plot(posterior)
coda::autocorr.plot(posterior)
coda::heidel.diag(posterior)
colnames(datos)
str(datos)
table(datos$sexo)
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Estado<-as.factor(datos$Estado)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
n<-nrow(datos)
n
x<-table(datos$Estado)[2]
x
# La previa de Jeffreys es Beta(0.5,0.5)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=4000)
str(datos)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos)
summary(model1)
library(MCMCpack)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos)
summary(model1)
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
library(coda)
library(MASS)
library(MCMCpack)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos)
summary(model1)
colnames(datos)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos)
summary(model1)
options(scipen = 999)
summary(model1)
?BayesFactor
Selec.model<-BayesFactor(model1,model2)
mod.probs<- PostProbMod(Selec.model)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos)
Selec.model<-BayesFactor(model1,model2)
mod.probs<- PostProbMod(Selec.model)
mod.probs
BayesFactor(model1,model2)
BayesFactor(model2,model1)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
Selec.model<-BayesFactor(model1,model2)
anova(model1,model2)
Selec.model<-BayesFactor(model1,model2)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos,mcmc = 4000)
model1 <- MCMClogit(Estado~Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos,mcmc = 4000)
model2 <- MCMClogit(Estado~Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
BayesFactor(model1,model2)
str(datos)
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
datos$Estado<-as.numeric(datos$Estado)
datos$Numero_Hijos<-as.numeric(datos$Numero_Hijos)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
Selec.model<-BayesFactor(model1,model2)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
BF<-BayesFactor(model1,model2)
2*BayesFactor(model1)$BF.logmarglike
names(summary(model1))
?DIC
??DIC
??MCMCglmm
??MCMCglmm
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
datos$Estado<-as.numeric(datos$Estado)
datos$Numero_Hijos<-as.numeric(datos$Numero_Hijos)
#2. Modelo logistico
library(coda)
library(MASS)
library(MCMCpack)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
names(model1)
