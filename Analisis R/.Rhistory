datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
View(datos)
str(datos)
table(datos$Estado)
prop.table(table(datos$Estado))
n<-nrow(datos)
table(datos$Estado)[2]
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=1000)
n<-nrow(datos)
n
x<-table(datos$Estado)[2]
x
# La previa de Jeffreys es Beta(0.5,0.5)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=1000)
summary(posterior)
plot(posterior)
grid <- seq(0,1,0.01)
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 16, 32), type="l", col="red", lwd=3, ylim=c(0,8),
xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red", lwd=3,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
plot(density(posterior))
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0:100), lwd=3,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=3,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=3)
legend(.75, 3.6, c("prior", "posterior"), lwd=3, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend(topright, c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend(40, 8, c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend("topright", c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend("topright", c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid()
x <- 0:1
curve(dbeta(x, 0.5+x, 0.5+n-x), xlab = "x", ylab = "f(x;a,b)", 0,1, col = "red", lwd = 2,
main = "")
curve(dbeta(x, 0.5, 0.5), xlab = "x", ylab = "f(x;a,b)", 0, 1, col = "purple", lwd = 2,
add = TRUE)
legend("topleft", c( "Posterior","Previa"), col = c( "red", "purple"), lwd = 2, inset = 0.05)
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=1.5,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=1.5)
legend("topright", c("prior", "posterior"), lwd=1.5, col=c("red", "blue"))
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
geweke.diag(posterior)
coda::geweke.plot(posterior)
coda::raftery.diag(posterior) # Longitud de la cadena
n<-nrow(datos)
n
x<-table(datos$Estado)[2]
x
# La previa de Jeffreys es Beta(0.5,0.5)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=4000)
summary(posterior)
plot(posterior)
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
coda::raftery.diag(posterior) # Longitud de la cadena
coda::geweke.plot(posterior)
coda::autocorr.plot(posterior)
coda::geweke.plot(posterior)
coda::autocorr.plot(posterior)
coda::heidel.diag(posterior)
colnames(datos)
str(datos)
table(datos$sexo)
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Estado<-as.factor(datos$Estado)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
n<-nrow(datos)
n
x<-table(datos$Estado)[2]
x
# La previa de Jeffreys es Beta(0.5,0.5)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=4000)
str(datos)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos)
summary(model1)
library(MCMCpack)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos)
summary(model1)
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
library(coda)
library(MASS)
library(MCMCpack)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos)
summary(model1)
colnames(datos)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos)
summary(model1)
options(scipen = 999)
summary(model1)
?BayesFactor
Selec.model<-BayesFactor(model1,model2)
mod.probs<- PostProbMod(Selec.model)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos)
Selec.model<-BayesFactor(model1,model2)
mod.probs<- PostProbMod(Selec.model)
mod.probs
BayesFactor(model1,model2)
BayesFactor(model2,model1)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
Selec.model<-BayesFactor(model1,model2)
anova(model1,model2)
Selec.model<-BayesFactor(model1,model2)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos,mcmc = 4000)
model1 <- MCMClogit(Estado~Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
model1 <- MCMClogit(Estado~1, b0=0, B0=.001, data=datos,mcmc = 4000)
model2 <- MCMClogit(Estado~Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
BayesFactor(model1,model2)
str(datos)
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
datos$Estado<-as.numeric(datos$Estado)
datos$Numero_Hijos<-as.numeric(datos$Numero_Hijos)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
Selec.model<-BayesFactor(model1,model2)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
BF<-BayesFactor(model1,model2)
2*BayesFactor(model1)$BF.logmarglike
names(summary(model1))
?DIC
??DIC
??MCMCglmm
??MCMCglmm
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
datos$Estado<-as.numeric(datos$Estado)
datos$Numero_Hijos<-as.numeric(datos$Numero_Hijos)
#2. Modelo logistico
library(coda)
library(MASS)
library(MCMCpack)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000)
summary(model1)
#Quitar # hijos
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo, b0=0, B0=.001, data=datos,mcmc = 4000)
names(model1)
datos=read.csv("BASE SEGUROS.csv",sep = ";",dec=",",stringsAsFactors = F)
datos$Producto<-as.factor(datos$Producto)
datos$Moneda<-as.factor(datos$Moneda)
datos$Plan<-as.factor(datos$Plan)
datos$MedioPagoEmisor<-as.factor(datos$MedioPagoEmisor)
datos$MedioPagoPlan<-as.factor(datos$MedioPagoPlan)
datos$sexo<-as.factor(datos$sexo)
datos$Estado<-as.numeric(datos$Estado)
datos$Numero_Hijos<-as.numeric(datos$Numero_Hijos)
n<-nrow(datos)
n
x<-table(datos$Estado)[2]
x
# La previa de Jeffreys es Beta(0.5,0.5)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=4000)
summary(posterior)
plot(posterior)
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
#convergencia
# Longitud de la cadena
coda::raftery.diag(posterior)
#1.Geweke
#Alcanza convergencia ya que en el gráfico se observa que los puntos estan dentro de los límites.
coda::geweke.plot(posterior)
#2.Gráfico de autocorrelación
#Si hay convergencia ya que el primer rezago es alto y luego las barras de los otros rezagos disminuyen.
coda::autocorr.plot(posterior)
#3.Heidelberger y Welch
#Los valores muestreados para cada variable forman un proceso estacionario, ya que no se rechaza
#la hipótesis nula. Por lo que se puede decir que se alcanza convergencia.
coda::heidel.diag(posterior)
library(coda)
library(MASS)
library(MCMCpack)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,
mcmc = 4000,marginal.likelihood ="Laplace")
summary(model1)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+
MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
??MCMClogit
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace",
optim(theta.start, logpost.logit, method = "Nelder-Mead",hessian=FALSE,control=list(fnscale=-1)))
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace",
optim( method = "Nelder-Mead",hessian=FALSE,control=list(fnscale=-1)))
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
View(datos)
model1 <- MCMClogit(Estado~Producto+Moneda,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+MedioPagoPlan,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor+MedioPagoPlan, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual+MedioPagoEmisor, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+PrimaMensual, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
BayesFactor(model1)
model1 <- MCMClogit(Estado~Producto+Moneda+Antiguedad, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Antiguedad+Plan, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Antiguedad+Plan+sexo, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Antiguedad+Plan+sexo+PrimaMensual, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
summary(datos$PrimaMensual)
model1 <- MCMClogit(Estado~PrimaMensual, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~MedioPagoEmisor, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~MedioPagoPlan, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Antiguedad+edad, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~sexo+Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad+sexo+Numero_Hijos,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
BayesFactor(model1)
model1 <- MCMClogit(Estado~Producto+Moneda+Plan+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad+sexo+
Numero_Hijos,b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
summary(model1)
model2 <- MCMClogit(Estado~Producto+Moneda+Plan+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad+
Numero_Hijos, b0=0, B0=.001, data=datos,mcmc = 4000,
marginal.likelihood ="Laplace")
BF<-BayesFactor(model1,model2)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model2)
model3 <- MCMClogit(Estado~Producto+Moneda+Plan+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
BF<-BayesFactor(model2,model3)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model3)
model4 <- MCMClogit(Estado~Producto+Moneda+Plan+MedioPagoEmisor+MedioPagoPlan+Antiguedad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
BF<-BayesFactor(model3,model4)
mod.probs<- PostProbMod(BF)
mod.probs
options(scipen = 999)
BF<-BayesFactor(model3,model4)
mod.probs<- PostProbMod(BF)
mod.probs
model4 <- MCMClogit(Estado~Producto+Plan+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo3  (con edad)
BF<-BayesFactor(model3,model4)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model4)
model5 <- MCMClogit(Estado~Producto+MedioPagoEmisor+MedioPagoPlan+Antiguedad+edad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
BF<-BayesFactor(model4,model5)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model5)
model6 <- MCMClogit(Estado~Producto+MedioPagoPlan+Antiguedad+edad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo5  (sin plan)
BF<-BayesFactor(model5,model6)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model6)
model7 <- MCMClogit(Estado~Producto+Antiguedad+edad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo6  (sin medio de pago emisor)
BF<-BayesFactor(model6,model7)
mod.probs<- PostProbMod(BF)
mod.probs
model7 <- MCMClogit(Estado~MedioPagoPlan+Antiguedad+edad,
b0=0, B0=.001, data=datos,mcmc = 4000,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo6  (sin medio de pago emisor)
BF<-BayesFactor(model6,model7)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model6)
plot(model6)
datos=read.csv("datasets_14872_228180_Admission_Predict_Ver1.1.csv",sep = ",",dec=".",stringsAsFactors = F)
View(datos)
str(datos)
datos<-datos[,-1]
str(datos)
datos$GRE.Score<-as.numeric(datos$GRE.Score)
datos$TOEFL.Score<-as.numeric(datos$TOEFL.Score)
datos$University.Rating<-as.numeric(datos$University.Rating)
datos$Research<-as.numeric(datos$Research)
str(datos)
n<-nrow(datos)
n
table(datos$Research)[2]
table(datos$Research)
x<-table(datos$Research)[2]
x
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=4000)
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,100), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,40), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
grid <- seq(0,1,0.01)
plot(grid, dbeta(grid, 0.5, 0.5), type="l", col="red",ylim=c(0,20), lwd=2,xlab="pi", ylab="density")
lines(density(posterior), col="blue", lwd=2)
legend("topright", c("prior", "posterior"), lwd=2, col=c("red", "blue"))
grid()
coda::raftery.diag(posterior)
coda::geweke.plot(posterior)
posterior <- MCMCpack::MCbinomialbeta(x, n, alpha=0.5, beta=0.5, mc=3750)
coda::geweke.plot(posterior)
coda::raftery.diag(posterior)
coda::autocorr.plot(posterior)
coda::heidel.diag(posterior)
library(coda)
library(MASS)
library(MCMCpack)
colnames(datos)
model1 <- MCMClogit(Research~GRE.Score+TOEFL.Score+University.Rating+SOP+LOR+CGPA+Chance.of.Admit,
b0=0, B0=.001, data=datos,mcmc = 3750,marginal.likelihood ="Laplace")
summary(model1)
#Quitar TOEFL.Score
model2 <-MCMClogit(Research~GRE.Score+University.Rating+SOP+LOR+CGPA+Chance.of.Admit,
b0=0, B0=.001, data=datos,mcmc = 3750,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo 2 (sin sexo)
BF<-BayesFactor(model1,model2)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model2)
model3 <-MCMClogit(Research~GRE.Score+SOP+LOR+CGPA+Chance.of.Admit,
b0=0, B0=.001, data=datos,mcmc = 3750,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo 2 (sin TOEFL.Score )
BF<-BayesFactor(model2,model3)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model3)
model4 <-MCMClogit(Research~GRE.Score+LOR+CGPA+Chance.of.Admit,
b0=0, B0=.001, data=datos,mcmc = 3750,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo 3 (sin University.Rating)
BF<-BayesFactor(model3,model4)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model4)
model5 <-MCMClogit(Research~GRE.Score+CGPA+Chance.of.Admit,
b0=0, B0=.001, data=datos,mcmc = 3750,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo 4 (sin SOP)
BF<-BayesFactor(model4,model5)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model1)
model2 <-MCMClogit(Research~GRE.Score+Chance.of.Admit,
b0=0, B0=.001, data=datos,mcmc = 3750,marginal.likelihood ="Laplace")
#Modelo más probable es el modelo 2 (sin TOEFL.Score )
BF<-BayesFactor(model1,model2)
mod.probs<- PostProbMod(BF)
mod.probs
summary(model2)
